define("underscore backbone backboneCommon ajaxControl command js/view/chara/CharaListPartsView text!template/chara/CharaList.html text!template/chara/CharaListParts.html sortUtil".split(" "),function(c,m,b,t,n,e,p,q,r){return m.View.extend({id:"charaListWrap",events:function(){var a={};a[b.cgti+" #sortPopup"]=this.sortPop;a[b.cgti+" #sortBtn"]=this.sortStart;a[b.cgti+" .orderBtn"]=this.sortOrder;return a},initialize:function(a){this.listenTo(this,"remove",this.removeView);this.template=c.template(p);
e.prototype.template=c.template(q);e.prototype.parentView=this;this.cardSort=new r("CharaTop_chara",this);this.charaViews={};this.initSelectCardId=this.selectCardId=null},charaSelect:function(a,b){a&&(c.each(this.charaViews,function(c){a==c.model.toJSON().userCardId&&c.charaSelectFunc(b)}),this.selectCardId=a)},filterFunc:function(){if(this.cardSort){var a=null,g=this.cardSort.getFilterType(),h=this.cardSort.getFilterRare(),f=g?g.split(","):[],e=h?h.split(","):[],k=this;c.each(this.charaViews,function(d){var h=
!1,g=!1;f.length?c.each(f,function(a){d.el.classList.contains(a)&&(h=!0)}):h=!0;e.length?c.each(e,function(a){d.el.classList.contains(a)&&(g=!0)}):g=!0;h&&g||d.el.classList.contains("formationRemove")||d.el.classList.contains("formationCurrent")?(b.removeClass(d.el,"hide"),a||(a=d.model.toJSON().userCardId)):(b.addClass(d.el,"hide"),k.selectCardId&&d.model.toJSON())});f.length||e.length?b.addClass(b.doc.querySelector("#sortPopup"),"filterOn"):b.removeClass(b.doc.querySelector("#sortPopup"),"filterOn");
this.cardSort.memoryHash&&(b.sfml[this.cardSort.memoryHash]=this.cardSort.sortPrm,b.sfm())}var l=0;c.each(this.el.querySelectorAll(".userCharaIcon"),function(a){a.classList.contains("hide")||l++});0==l?b.removeClass(b.doc.querySelector(".charaListCaution"),"hide"):b.addClass(b.doc.querySelector(".charaListCaution"),"hide");k=this;if(this.initSelectCardId)k.charaSelect(this.initSelectCardId,!0),k.initSelectCardId=null;else if(!this.selectCardId||this.selectCardId&&this.charaViews[this.selectCardId].el.classList.contains("hide"))a=
null,c.each(this.el.querySelectorAll("#charaListElms li"),function(b,c){a||b.classList.contains("hide")||(a=b.querySelector(".prm_userCardId").textContent,k.charaSelect(a,!0))}),a||c.each(this.el.querySelectorAll("#charaListElms li"),function(b,c){a||(a=b.querySelector(".prm_userCardId").textContent,k.charaSelect(a,!0))});b.scrollRefresh()},render:function(){var a=b.doc.createDocumentFragment(),c=this;this.$el.html(this.template({model:this.model.toJSON()}));this.collection.each(function(b,f){f=new e({model:b});
c.charaViews[b.toJSON().userCardId]=f;a.appendChild(f.render("init").el)});this.el.querySelector("#charaListElms").appendChild(a);n.getBaseData(b.getNativeObj());return this},sortPop:function(a){a.preventDefault();b.isScrolled()||this.cardSort.sortPopupOpen(a)},sortStart:function(a){a.preventDefault();b.isScrolled()||(this.cardSort.sortPrm[0]={get:"level",level:"rank",rank:"atk",atk:"def",def:"hp",hp:"eplv",eplv:"rev",rev:"mlv",mlv:"get"}[this.cardSort.sortPrm[0]],this.cardSort.multiSort(this.cardSort.sortPrm))},
sortOrder:function(a){a.preventDefault();b.isScrolled()||("asc"===this.cardSort.getAscId()?this.cardSort.sortPrm[1]="desc":this.cardSort.sortPrm[1]="asc",this.cardSort.ascSort(this.cardSort.sortPrm[1]))},removeView:function(){this.off();this.remove()}})});