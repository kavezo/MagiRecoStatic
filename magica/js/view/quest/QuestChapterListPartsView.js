define("underscore backbone backboneCommon ajaxControl js/view/quest/QuestSectionListPartsView QuestUtil".split(" "),function(c,d,b,h,e,g){return d.View.extend({tagName:"li",id:function(){return"chapter_"+this.model.chapter.chapterNoForView},className:"chapter scrollElm se_decide",events:function(){var a={};a[b.cgti+" .chapterTitleWrap"]=this.titleTapFunc;return a},initialize:function(a){this.listenTo(this.rootView,"removeView",this.removeView);this.listenTo(this.rootView,"modeToggle",this.removeView);
this.listenTo(this.rootView,"appendComp",this.createSection)},render:function(){this.$el.html(this.template({model:this.model}));this.el.setAttribute("id","chapter_"+this.model.chapter.chapterNoForView);if("SINGLERAID"==this.model.chapter.chapterType||"BRANCH"==this.model.chapter.chapterType){var a="url("+("/magica/resource/image_web/page/quest/main/titleBg/bg_chapter_"+("HARD"==b.mainQuestMode?"challenge_"+this.model.chapterId:this.model.chapterId)+".png")+") left center no-repeat";this.el.querySelector(".chapterTitleWrap").style.background=
a}return this},createSection:function(){this.sectionList=b.doc.getElementById("chapter_"+this.model.chapter.chapterNoForView).getElementsByClassName("sectionList")[0];var a=this.model.sectionList;a.sort(function(a,b){return a.section.genericIndex>b.section.genericIndex?-1:a.section.genericIndex<b.section.genericIndex?1:0});e.prototype.template=c.template($("#SectionParts").text());e.prototype.parentView=this;var f=b.doc.createDocumentFragment(),d=this.model.chapter.chapterNoForView;c.each(a,function(a,
b){a=$.extend(a,{chapterNoForView:d});a.chestColor=g.clearRewardChestColor(a.section.clearReward);var c=new e({model:a});f.appendChild(c.render().el);0!==b||a.cleared||(c.parentView.outline=a)});this.sectionList.appendChild(f)},titleTapFunc:function(a){a.preventDefault();if(!b.isScrolled())switch(this.model.chapter.chapterType){case "NORMAL":this.toggleChapter();break;case "SINGLERAID":this.singleRaidLink();break;case "BRANCH":this.branchLink()}},toggleChapter:function(a){this.el.classList.toggle("open");
c.each(this.el.querySelectorAll("li"),function(a){a.classList.toggle("scrollElm")});this.rootView.listScroll.refresh()},singleRaidLink:function(a){console.log(this.model);b.mainChapterId=this.model.chapterId;location.href="#/MainQuestSingleRaid"},branchLink:function(a){console.log(this.model);b.mainChapterId=this.model.chapterId;location.href="#/MainQuestBranch"},removeView:function(){this.trigger("removeView");this.off();this.remove()}})});