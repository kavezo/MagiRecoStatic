define(["underscore","backbone","backboneCommon","ajaxControl","text!template/card/CardSort.html"],function(f,g,b,h,k){var d;return g.View.extend({events:function(){var a={};a[b.cgti+" #filterAttList .filterAtt"]=this.typeFilter;a[b.cgti+" #filterRankList .filterRank"]=this.rankFilter;a[b.cgti+" #cardSortBtnsArea .sort"]=this.reSort;return a},initialize:function(){d=this.cardSort;this.template=f.template(k);this.memoryHash=d.memoryHash;this.sortPrm=d.sortPrm.concat()},render:function(){this.$el.html(this.template(h.getPageJson()));
return this},typeFilter:function(a){a.preventDefault();if(!b.isScrolled()){var c;if("ALL"==a.currentTarget.dataset.typeFilter)a.currentTarget.classList.contains("current")||(c=b.doc.getElementById("filterAttList").getElementsByClassName("filterAtt"),this.sortPrm[2]=null,f.each(c,function(a){b.removeClass(a,"current")}),a.currentTarget.classList.toggle("current"));else if(b.removeClass(b.doc.querySelector("#filterAttList .ALL"),"current"),a.currentTarget.classList.toggle("current"),c=b.doc.getElementById("filterAttList").getElementsByClassName("current"),
0<c.length){a="";for(var e=0,d=c.length;e<d;e++)""!==a&&(a+=","),a+=c[e].dataset.typeFilter;this.sortPrm[2]=a}else b.addClass(b.doc.querySelector("#filterAttList .ALL"),"current"),this.sortPrm[2]=null}},rankFilter:function(a){a.preventDefault();if(!b.isScrolled()){var c;if("ALL"==a.currentTarget.dataset.rankfilterId)a.currentTarget.classList.contains("current")||(c=b.doc.getElementById("filterRankList").getElementsByClassName("filterRank"),this.sortPrm[3]=null,f.each(c,function(a){b.removeClass(a,
"current")}),a.currentTarget.classList.toggle("current"));else if(b.removeClass(b.doc.querySelector("#filterRankList .ALL"),"current"),a.currentTarget.classList.toggle("current"),c=b.doc.getElementById("filterRankList").getElementsByClassName("current"),0<c.length){a="";for(var e=0,d=c.length;e<d;e++)""!==a&&(a+=","),a+=c[e].dataset.rankfilterId;this.sortPrm[3]=a}else b.addClass(b.doc.querySelector("#filterRankList .ALL"),"current"),this.sortPrm[3]=null}},reSort:function(){this.memoryHash&&(b.sfml[this.memoryHash]=
this.sortPrm,b.sfm());d.multiSort(this.sortPrm)}})});